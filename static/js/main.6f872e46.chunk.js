(this.webpackJsonptest_task=this.webpackJsonptest_task||[]).push([[0],{159:function(e,t,a){e.exports={main:"App_main__YXBXY"}},189:function(e,t,a){},346:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(52),c=a.n(r),i=(a(188),a(189),a(159)),l=a.n(i),o=a(21),d=a(178),j=a(43),u=a.n(j),b=a(2);function h(e){var t=e.sendUserData,a=Object(d.a)(),n=a.register,s=a.handleSubmit,r=(new Date).toISOString().split("T")[0];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{className:u.a.header,children:"New users "}),Object(b.jsxs)("form",{onSubmit:s((function(e){return t(e)})),className:u.a.form,children:[Object(b.jsxs)("label",{htmlFor:"dateRegister",className:u.a.label,children:["Date Registration:",Object(b.jsx)("input",Object(o.a)({id:"dateRegister",className:u.a.input,type:"date",max:r},n("dateRegister",{required:!0})))]}),Object(b.jsxs)("label",{htmlFor:"dateActive",className:u.a.label,children:["Date Last Activity:",Object(b.jsx)("input",Object(o.a)({id:"dateActive",className:u.a.input,type:"date",max:r},n("dateActive",{required:!0})))]}),Object(b.jsx)("button",{className:u.a.btn,children:"Send"})]})]})}var m=a(73),g=a.n(m);function O(e){var t=e.el;return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("li",{className:g.a.li,children:[Object(b.jsx)("span",{className:g.a.element,children:t.id}),Object(b.jsx)("span",{className:g.a.element,children:t.data.dateRegister}),Object(b.jsx)("span",{className:g.a.element,children:t.data.dateActive})]})})}var x=a(48),p=a.n(x);function f(e){var t=e.users;return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("ul",{className:p.a.lists,children:t.length>0?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("li",{className:p.a.elem,children:[Object(b.jsx)("span",{className:p.a.item,children:"ID USERS"}),Object(b.jsx)("span",{className:p.a.item,children:"DATE REGISTRATION"}),Object(b.jsx)("span",{className:p.a.item,children:"DATE LAST ACTIVITY"})]}),t.map((function(e){return Object(b.jsx)(O,{el:e},e.id)}))]}):Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("span",{className:p.a.nothing,children:"Missing data, please add new users"})})})})}var _=a(32),U=a(92),v=Object(U.b)({name:"defaultValues",initialState:{users:[],diagram:[],registeredUsers:0,realUser:0,rollingRetention:[]},reducers:{getUser:function(e,t){return Object(o.a)(Object(o.a)({},e),{},{users:t.payload})},newUser:function(e,t){var a=e.users.length;e.users.push({id:a+1,data:t.payload})},getDiagram:function(e,t){return Object(o.a)(Object(o.a)({},e),{},{diagram:t.payload})},getRegisteredUsers:function(e,t){return Object(o.a)(Object(o.a)({},e),{},{registeredUsers:t.payload})},getRealUser:function(e,t){return Object(o.a)(Object(o.a)({},e),{},{realUser:t.payload})},getRollingRetention:function(e,t){return Object(o.a)(Object(o.a)({},e),{},{rollingRetention:t.payload})}}}),D=v.actions,R=D.getUser,N=D.newUser,S=D.getDiagram,k=D.getRegisteredUsers,y=D.getRealUser,I=D.getRollingRetention,w=v.reducer,A=a(17),F=a(61),C=a.n(F),T=a(348),L=a(179),G=a(352),E=a(174),K=a(175),M=a(76),V=a(49),X=a.n(V);function Y(e){var t=e.data,a=e.numberDate,n=e.allUser,s=e.dataRolling,r=Math.round(n.realUser/n.registeredUsers*100)+"%";return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("h2",{className:X.a.head,children:["Retention ",a," day: ",r," "]}),Object(b.jsxs)("div",{className:X.a.block,children:[Object(b.jsxs)("span",{className:X.a.el,children:["All users : ",n.registeredUsers]}),Object(b.jsxs)("span",{className:X.a.el,children:["Real users : ",n.realUser]}),Object(b.jsxs)("span",{className:X.a.el,children:["Days count : ",a]})]}),Object(b.jsxs)(T.a,{width:770,height:300,data:t,margin:{top:20,right:40,bottom:20,left:10},children:[Object(b.jsx)(L.a,{type:"monotone",dataKey:"User",stroke:"#8884d8"}),Object(b.jsx)(G.a,{stroke:"#ccc"}),Object(b.jsx)(E.a,{dataKey:"name"}),Object(b.jsx)(K.a,{}),Object(b.jsx)(M.a,{})]}),Object(b.jsxs)("h2",{className:X.a.head,children:["Rolling Retention 7 day ",s[6].User," %"," "]}),Object(b.jsxs)(T.a,{width:770,height:300,data:s,margin:{top:20,right:40,bottom:20,left:10},children:[Object(b.jsx)(L.a,{type:"monotone",dataKey:"User",stroke:"#8884d8"}),Object(b.jsx)(G.a,{stroke:"#ccc"}),Object(b.jsx)(E.a,{dataKey:"name"}),Object(b.jsx)(K.a,{}),Object(b.jsx)(M.a,{})]})]})}function q(e){var t=e.users,a=e.saveData,n=e.deleteData,s=Object(_.b)(),r=Object(_.c)((function(e){return e.default.diagram})),c=Object(_.c)((function(e){return e.default.rollingRetention})),i=Object(_.c)((function(e){return e.default})),l=function(){for(var e=[],a=[],n=0;n<t.length;n++){var r=t[n].data.dateRegister,c=t[n].data.dateActive,i=new Date;i.setDate(i.getDate()-7);var l=i.toISOString().slice(0,10);c>=l&&r>=l?e.push(t[n].data.dateActive):c<l&&r>=l&&(a.push(t[n]),console.log("Registration date is less than current date"))}var o=e.length+a.length;s(k(o)),s(y(e.length));var j=e.reduce((function(e,t){return e[t]=(e[t]||0)+1,e}),{}),u=d(j);u.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})),s(S(u))},o=function(){for(var e=[],a=0;a<7;a++)e[a]=0;for(var n=d(e),r=t.map((function(e){return e.data})),c=0;c<r.length;c++){var i=r[c].dateRegister,l=r[c].dateActive,o=new Date(i);o.setDate(o.getDate()+7);var j=o.toISOString().slice(0,10);if(i<=l&&l<j){n[0].User++;var u=new Date(i);u.setDate(u.getDate()+1)&&u.toISOString().slice(0,10)===l&&n[1].User++,u.setDate(u.getDate()+1)&&u.toISOString().slice(0,10)===l&&n[2].User++,u.setDate(u.getDate()+1)&&u.toISOString().slice(0,10)===l&&n[3].User++,u.setDate(u.getDate()+1)&&u.toISOString().slice(0,10)===l&&n[4].User++,u.setDate(u.getDate()+1)&&u.toISOString().slice(0,10)===l&&n[5].User++,u.setDate(u.getDate()+1)&&u.toISOString().slice(0,10)===l&&n[6].User++}else if(l>j)for(var b=0;b<n.length;b++)n[b].User++}console.log(n);for(var h=[],m=0;m<n.length;m++){var g=n[0].User;h.push(Math.round(n[m].User/g*100))}h=d(h),s(I(h))};function d(e){return Object.entries(e).map((function(e){var t=Object(A.a)(e,2);return{name:t[0],User:t[1]}}))}return Object(b.jsx)(b.Fragment,{children:t.length>0&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:C.a.block,children:[Object(b.jsx)("button",{className:C.a.btn,onClick:a,children:"Save"}),Object(b.jsx)("button",{className:C.a.btn,onClick:function(){l(),o()},children:"Calculate"}),Object(b.jsx)("button",{className:C.a.btn,onClick:n,children:"Delete"})]}),Object(b.jsx)("div",{className:C.a.wrapper,children:c.length>0&&Object(b.jsx)(Y,{data:r,dataRolling:c,numberDate:7,allUser:i})})]})})}var B=a(176),Q=a.n(B).a.create({baseURL:"https://p1antain.api.nomoredomains.club/",headers:{"Content-Type":"application/json"}}),W=function(){return Q.get("card")},J=function(e){return Q.post("card",e)},Z=function(){return Q.delete("card")};var z=function(){var e=Object(_.b)(),t=Object(_.c)((function(e){return e.default.users}));return s.a.useEffect((function(){t.length<=0&&W().then((function(t){return e(R(t.data.data))}))}),[]),Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{className:l.a.main,children:[Object(b.jsx)(h,{sendUserData:function(t){e(N(t))}}),Object(b.jsx)(f,{users:t}),Object(b.jsx)(q,{users:t,saveData:function(){J(t).then((function(){return console.log("Send completed")}))},deleteData:function(){Z().then((function(){console.log("Deletion completed"),W().then((function(t){return e(R(t.data.data))}))}))}})]})})},H=Object(U.a)({reducer:{default:w}});c.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(_.a,{store:H,children:Object(b.jsx)(z,{})})}),document.getElementById("root"))},43:function(e,t,a){e.exports={header:"CreateUser_header__2e1wX",form:"CreateUser_form__2bGcX",label:"CreateUser_label__2_6rx",input:"CreateUser_input__FcvLZ",btn:"CreateUser_btn__itDQG"}},48:function(e,t,a){e.exports={lists:"UserLists_lists__2xl1z",elem:"UserLists_elem__3D4m2",item:"UserLists_item__1nIiP",nothing:"UserLists_nothing__1VIDq"}},49:function(e,t,a){e.exports={block:"RechartGraphics_block__3rh8G",el:"RechartGraphics_el__mQtNK",head:"RechartGraphics_head__aQ6Hv"}},61:function(e,t,a){e.exports={block:"WorkingData_block__2soI0",btn:"WorkingData_btn__1R8YB",wrapper:"WorkingData_wrapper__1UVk9"}},73:function(e,t,a){e.exports={li:"User_li__2SjZi",element:"User_element__3Kxbc"}}},[[346,1,2]]]);
//# sourceMappingURL=main.6f872e46.chunk.js.map